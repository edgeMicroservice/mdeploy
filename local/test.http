###
@host = http://localhost:8083
@imagename = mdeploy
####
GET {{host}}/mcm/v1/images
Authorization: bearer {{edgeToken}}

####
POST {{host}}/mcm/v1/images
Content-Type: multipart/form-data; boundary=$Boundary$
Authorization: Bearer {{edgeToken}}

--$Boundary$
Content-Disposition: form-data; name="image"; filename="{{imagename}}-v1.tar"

< ../deploy/{{imagename}}-v1.tar
--$Boundary$--


####
POST {{host}}/mcm/v1/containers
Content-Type: application/json
Authorization: Bearer {{edgeToken}}

{
  "env": {
    "MCM.BASE_API_PATH": "/{{imagename}}/v1",
    "MCM.WEBSOCKET_SUPPORT": "true",
    "OAUTH_GENERIC_KEY": "--oauth-system-generic-public-key--",
    "OAUTH_CLIENT_ID": "--oauth-client-id--",
    "OAUTH_CLIENT_SECRET": "--oauth-client-secret--",
    "SESSION_SECURITY_AUTHORIZATION_SET": "off",
    "MST_URL": "http://localhost:8025/mST/v1",
    "CUSTOMER_CODE": "--customer-code--",
    "MDEPLOYMENYAGENT_URL": "ws://",
    "SESSION_KEYS_MAP": "[{\"sessionId\": \"--random-16-chars--\",\"sessionSecret\": \"--random-32-chars--\",\"projectId\": \"--project-client-id--\"}]"
  },
  "id": "{{imagename}}-v1",
  "image": "{{imagename}}-v1",
  "imageId": "{{imagename}}-v1",
  "name": "{{imagename}}-v1",
  "state": "started"
}

###
GET {{host}}/{{clientId}}/{{imagename}}/v1/images
Content-Type: application/json
Authorization: Bearer {{edgeToken}}


####
POST {{host}}/{{clientId}}/{{imagename}}/v1/images
Content-Type: application/json
Authorization: Bearer {{edgeToken}}

{
    "nodeId": "1d80503a96a893bec5a0dba50612b7dde2e438dd98793256bdd50a8f",
    "imageId": "{{clientId}}-{{imagename}}-v1"
}

####
PUT {{host}}/{{clientId}}/{{imagename}}/v1/clients
Content-Type: application/json
Authorization: Bearer {{edgeToken}}

{
  "status": "active"
}

###

POST http://localhost:8083/jsonrpc/v1
Content-Content-Type: application/json

{"jsonrpc": "2.0", "method": "getMe", "params": ["{{edgeToken}}"], "id": 1}

